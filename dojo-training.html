<div id="gacha-ui" style="background: #0a0a0a; color: white; padding: 25px; border-radius: 15px; border: 2px solid #e74c3c; font-family: 'Courier New', monospace; max-width: 450px; text-align: center; box-shadow: 0 0 15px #e74c3c;">
  <h2 style="color: #e74c3c; margin-bottom: 5px; text-transform: uppercase;">The Master's Trial</h2>
  <p style="font-size: 11px; color: #888;">"The weak need not apply. The strong will be broken."</p>
  
  <div id="step-1">
    <p style="font-size: 14px;"><b>Choose Your Path:</b></p>
    <select id="school-select" style="width: 100%; padding: 10px; background: #1a1a1a; color: #e74c3c; border: 1px solid #e74c3c; font-weight: bold;">
      <option value="Turtle">Turtle School (Roshi)</option>
      <option value="Crane">Crane School (Shen)</option>
      <option value="Orin">Orin Temple (Monks)</option>
      <option value="Mutaito">Mutaito Academy (Legacy)</option>
    </select>
    <button onclick="generateMission()" style="margin-top: 20px; background: #e74c3c; color: white; border: none; padding: 12px 25px; font-weight: bold; cursor: pointer; border-radius: 3px; width: 100%;">START TRAINING</button>
  </div>

  <div id="result" style="display:none; margin-top: 20px; padding: 15px; border: 1px dashed #444; background: #111;">
    <h3 id="rarity-tag" style="margin: 0; font-size: 20px;"></h3>
    <hr style="border: 0.5px solid #333; margin: 10px 0;">
    <p id="mission-desc" style="font-size: 13px; line-height: 1.5; color: #ccc;"></p>
    <div style="background: #000; padding: 10px; margin-top: 10px; border-radius: 5px;">
        <p id="reward-stats" style="margin: 0; font-weight: bold; font-size: 12px;"></p>
    </div>
    <p style="font-size: 10px; color: #666; margin-top: 10px;"><i>Log this result in #mission-log to begin your 7-day training.</i></p>
    <button onclick="resetGacha()" style="background: transparent; color: #444; border: none; font-size: 10px; cursor: pointer; text-decoration: underline;">Reset Enrollment</button>
  </div>
</div>

<script>
function generateMission() {
    // WEIGHTED RANDOM LOGIC
    // 45% Epic (Hardest Regular), 30% Rare, 20% Common, 5% Legendary
    const roll = Math.floor(Math.random() * 100) + 1;
    const school = document.getElementById('school-select').value;
    
    let rarity, color, mission, reward;

    if (roll <= 20) {
        rarity = "COMMON"; color = "#8b949e";
        mission = "Basic Endurance: The Master is busy. Perform 5,000 squats and clean the entire dojo grounds. (Min 250 Words)";
        reward = "+40 PL | 10% Tech Progress";
    } else if (roll <= 50) {
        rarity = "RARE"; color = "#1f6feb";
        mission = "Disciple Gauntlet: Spar against 3 senior students simultaneously. They will not hold back. (Min 400 Words)";
        reward = "+100 PL | 25% Tech Progress";
    } else if (roll <= 95) { // HIGHEST PROBABILITY (EPIC/HARD)
        rarity = "EPIC (HELLISH)"; color = "#8957e5";
        mission = "The Master's Wrath: " + school + " Master subjects you to a near-death training session. You must survive 12 hours of constant physical torture/training. (Min 600 Words)";
        reward = "+250 PL | 50% Tech Progress";
    } else {
        rarity = "LEGENDARY"; color = "#d29922";
        mission = "Divine Enlightenment: In the brink of collapse, you witness the true essence of " + school + " martial arts. A rare spiritual breakthrough.";
        reward = "+500 PL | INSTANT TECH UNLOCK";
    }

    document.getElementById('step-1').style.display = 'none';
    document.getElementById('result').style.display = 'block';
    document.getElementById('rarity-tag').innerText = rarity;
    document.getElementById('rarity-tag').style.color = color;
    document.getElementById('mission-desc').innerText = mission;
    document.getElementById('reward-stats').innerText = "REWARD: " + reward;
    document.getElementById('reward-stats').style.color = "#2ecc71";
}

function resetGacha() {
    document.getElementById('step-1').style.display = 'block';
    document.getElementById('result').style.display = 'none';
}
</script>
